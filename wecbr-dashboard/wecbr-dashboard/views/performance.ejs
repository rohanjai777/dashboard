<!DOCTYPE html>
<html>

<head>
  <title>Performance Page</title>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">

  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>

  <!-- Latest compiled JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/css/system.css">
  <link rel="stylesheet" type="text/css" href="/css/vertical-menu.min.css">
  <!-- <link rel="stylesheet" type="text/css" href="/css/performance.css"> -->
  <script type="text/javascript">
    $(function () {
      // Sidebar toggle behavior
      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
      });
    });

    function handleClick(box) {
      console.log(box.id);
      if (box.checked === true)
        window.location.pathname = '/assignManager/' + box.id
      else window.location.pathname = '/unassignManager/' + box.id
    }

    function changePosition(i) {
      console.log(i.value, i.id)
      let pathname = i.id + '/' + i.value;
      window.location.pathname = '/changePosition/' + pathname;
    }
  </script>
</head>

<body>
  <!-- Vertical navbar -->
  <div class="vertical-nav navbar-with-menu fixed-top navbar-semi-light bg-white" id="sidebar">
    <div class="py-4 px-3 mb-4 bg-light">
      <div class="media d-flex align-items-center"><img src="/images/wecbr.logo.png" alt="..." width="65"
          class="mr-3 rounded-circle img-thumbnail shadow-sm">
        <div class="media-body">
          <h4 class="m-0" style="font: 1.3rem;">WECBR</h4>
        </div>
      </div>
    </div>

    <p class="text-gray font-weight-bold text-uppercase px-3 small pb-4 mb-0">Main</p>

    <%- include('sidebar.ejs',{user:user}); %>
  </div>
  <!-- End vertical navbar -->

  <!-- Page content holder -->
  <div class="page-content p-5" id="content">
    <!-- Toggle button -->
    <button id="sidebarCollapse" type="button" class="btn btn-light bg-white rounded-pill shadow-sm px-4 mb-4"><i
        class="fa fa-bars mr-2"></i><small class="text-uppercase font-weight-bold">MENU</small></button>
    <button style="float:right;" id="sidebarCollapse" type="button"
      class="btn btn-light bg-white rounded-pill shadow-sm px-4 mb-4"><i class="fa fa-bell mr-2"></i></button>
    <!-- Demo content -->
    <div class="separator"></div>
    <div class="container emp-profile">
      <div class="main">
        <div class="table-responsive-md">
          <table class="table table-striped table-hover ">
            <thead>
              <tr class="bg-primary tableheading">
                <th scope="col">S.No</th>
                <th scope="col">Image</th>
                <th scope="col">Name</th>
                <th scope="col">Position</th>
                <th scope="col">Group No.</th>
                <th scope="col">Score</th>
                <th scope="col">Percentage</th>
                <th scope="col">Make Manager</th>
              </tr>
            </thead>
            <tbody>
              <% for(let i = 0; i < users.length; i++){ %>
              <tr class="clickable-row">
                <th scope="row"><%= i + 1 %> </th>
                <td>
                  <div class="col-md-6">
                    <div class="media d-flex align-items-center"><img src="/uploads/<%= users[i].cImage %> "
                        alt="clg logo" width="65" class="mr-3 rounded-circle img-thumbnail shadow-sm">
                    </div>
                  </div>
                </td>
                <td><a href="/users/<%= users[i]._id %>"><%= users[i].fName %></a></td>
                <td>
                  <%= users[i].position%>
                </td>
                <% if(users[i].groups) { %>
                <td><% for(let j=0; j < users[i].groups.length; j++) {%>
                  <%= users[i].groups[j].groupNumber %>||
                  <% } %>
                  <% } else { %>
                  Not Assigned
                  <% } %></td>
                <td></td>
                <td></td>
                <td><label class="switch">
                    <input type="checkbox" id='<%= users[i]._id%>' onclick="handleClick(this);"
                      <% if(users[i].isManager||users[i].tempManager){%> checked <% } %> <% if(!user.isManager){%>
                      disabled <% } %>>
                    <span class="slider round"></span>
                  </label>
                </td>
              </tr>
              <% } %>
            </tbody>
          </table>
        </div>
        <!-- /.container -->
      </div>
      <!-- /.main -->
    </div>
</body>

</html>